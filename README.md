puppet-installation-script
==========================

Puppet installation script is a simple automation tool to install puppet master and puppet client with minimal effort. User only need to know the required environment details to setup the puppet environment. All other configurations will be generated by this script.

# Things to know before running the script 

* User need to have ‘___root___’ or ‘___sudo___’ access to the system.

* There are two ways to execute the script;  
    1. Run the script in interactive mode.  

        Script will ask several questions that user need to answer. According to the answers script will install and configure the puppet master or the puppet client.  
    1. Pass information as command line arguments to the script.  

        User can specify all relevant parameters with relevant values and run the script. Those parameters will describe in following steps.  

* User should know following details  
    1. Install puppet master or puppet agent that the user need to install and configure. (*--master or --agent*)  
    1. Domain name that will associate with the environment. (*--domain your.domain.com*)  

        _eg: apps.wso2.com_  
    1. IP address of the instance the puppet master will be installed in. (*--master-ip 10.0.0.1*)  

        _eg: 10.10.10.10_  
    1. Host name convention of other instances. By default puppet master will have ‘puppetmaster’ as the host name. (*--hostname node001*)  

        _eg. node001, node002 …_ 

        ___** Note : Do not give any fully qualified domain names (FQDN) as hostname like node0023.apps.wso2.com.___  
    + Operating system on the instance. (*--os ubuntu*)  

        ___** Note : Currently this supports only for Ubuntu and Debian systems only.___  

# Get the puppet installation script

* Get a clone of the setup scripts from github.

    <pre> git clone https://github.com/thilinapiy/puppet-installation-script </pre>

# Installing puppet master

1. Copy the ___‘puppet-installation-script’___ to the desired instance.

1. Get the IP address of the instance. Make sure it is a static IP.

1. Change the current directory in to ___‘puppet-installation-script’___.

1. Run the script;

    In interactive mode:

    <pre> sudo python puppet_install.py  </pre>

    And set option as ***‘1’***.
        
    Or pass values as arguments;

    <pre> sudo python puppet_install.py --master \
                                    --domain apps.wso2.com \  
                                    --master-ip 10.1.1.1 \  
                                    --os ubuntu </pre>

# Installing puppet agent

1. First install the puppet master. If that is almost done get the IP address of it.

2. Fix a instance hostname naming convention like node001, node002, … .

3. Copy the ___‘puppet-installation-script’___ to the desired instance.

4. Change the current directory in to ___‘puppet-installation-script’___.

5. Run the script;

    In interactive mode:

    <pre> sudo python puppet_install.py  </pre>

    And set option as ***‘2’***.

    Or pass values as arguments:
    <pre> sudo python puppet_install.py --agent \
                                    --domain apps.wso2.com \
                                    --master-ip 10.1.1.1 \
                                    --hostname node001 \
                                    --os ubuntu  </pre>

# To verify (Optional)

1. Make ___‘manifests’___ directory in ___‘/mnt/puppet/your.domain.com/’___ location.
    <pre> mkdir   /mnt/puppet/apps.wso2.com/manifests </pre>

2. Create a ___‘site.pp’___ file in that location.
    <pre> touch   /mnt/puppet/apps.wso2.com/manifests/site.pp  </pre>

3. Add following script on that site.pp with respective hostname that you gave to the relevant node that you are going to test.
    <pre> node 'node001.apps.wso2.com' {

            file { '/mytestfile.t':
                    owner   => 'root',
                    group   => 'root',
                    content => "This will be on the file.\n",
                    ensure  => present,
            }
    } </pre>

4. On the puppet agent node (node001) run
    <pre> puppetd -vt  </pre>

5. Check the file in ___‘/mytestfile.t’___.
    <pre> cat /mytestfile.t  </pre>


